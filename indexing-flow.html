<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Automated Synchronization</title>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">

    <meta content='Understand the indexing flow and the generated operations.' name='description'>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport'>
    <!-- / Twitter card -->
    <meta content='summary_large_image' name='twitter:card'>
    <meta content='@Algolia' name='twitter:site'>
    <meta content='@Algolia' name='twitter:creator'>
    <meta content="Automated Synchronization - Algolia Search plugin for WordPress" name="twitter:title">
    <meta content="Understand the indexing flow and the generated operations." name="twitter:description">
    <!--meta content="Algolia Product image" name="twitter:image"-->
    <!-- / OG meta -->
    <!--meta content='#' property='og:url'-->
    <meta content='Automated Synchronization - Algolia Search plugin for WordPress' property='og:title'>
    <meta content='article' property='og:type'>
    <meta content='Understand the indexing flow and the generated operations.' property='og:description'>
    <meta content='Algolia Search plugin for Shopify' property='og:site_name'>
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <meta name="description" content="Understand the indexing flow and the generated operations.">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/github.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundicons/3.0.0/foundation-icons.min.css">
    <link rel="stylesheet" href="css/app.css?v=1473693977450">

    <link href='https://fonts.googleapis.com/css?family=Raleway:400,500,600' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <!-- at the end of the BODY -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
</head>
<body class="">
    <div class='ac-nav'>
        <div class="row">
            <div class="large-12 columns">
                <div class='ac-nav-container'>
                    <div class='ac-nav-brand'>
                        <a class='ac-logo' href='https://community.algolia.com/' title='Algolia Community'>
                            <img alt='Algolia Community' class='ac-logo__lg' src='https://res.cloudinary.com/hilnmyskv/image/upload/logo-community-inline-dark.svg' width='150'>
                            <img alt='Algolia Community' class='ac-logo__sm' src='https://res.cloudinary.com/hilnmyskv/image/upload/v1461180081/logo-community-sm.svg'>
                        </a>
                        <span class='ac-nav-brand-breadcrumb'></span>
                        <a class='ac-nav-brand-title' href='./' title='Home'>Shopify plugin</a>
                    </div>
                    <div class='ac-nav-menu'>
                        <div class='ac-nav-searchbox'>
                            <div class='svg-icons' style='height: 0; width: 0; position: absolute; visibility: hidden'>
                                <svg xmlns='http://www.w3.org/2000/svg'>
                                    <symbol id="sbx-icon-clear-3" viewBox="0 0 40 40"><path d="M16.228 20L1.886 5.657 0 3.772 3.772 0l1.885 1.886L20 16.228 34.343 1.886 36.228 0 40 3.772l-1.886 1.885L23.772 20l14.342 14.343L40 36.228 36.228 40l-1.885-1.886L20 23.772 5.657 38.114 3.772 40 0 36.228l1.886-1.885L16.228 20z" fill-rule="evenodd"/></symbol>
                                    <symbol id="sbx-icon-search-13" viewBox="0 0 12 12"><path d="M12 11.077c0-.245-.1-.483-.267-.65L9.26 7.955c.584-.843.894-1.853.894-2.877C10.154 2.272 7.882 0 5.077 0S0 2.272 0 5.077s2.272 5.077 5.077 5.077c1.024 0 2.034-.31 2.877-.894l2.474 2.466c.166.173.404.274.65.274.504 0 .922-.418.922-.923zm-3.692-6c0 1.78-1.45 3.23-3.23 3.23-1.782 0-3.232-1.45-3.232-3.23s1.45-3.23 3.23-3.23c1.782 0 3.232 1.45 3.232 3.23z" fill="#FFF" fill-rule="evenodd" opacity="0.85"/></symbol>
                                </svg>
                            </div>
                        </div>
                        <ul class='ac-nav-menu-list'>
                            <li class="ac-nav-menu-list-item">
                                <a href="./" data-path="./" title="Home">Home</a>
                            </li>
                            <li class="ac-nav-menu-list-item active">
                                <a href="installation.html" data-path="installation.html" title="Documentation">Documentation</a>
                            </li>
                            <li class="ac-nav-menu-list-item">
                                <a href="frequently-asked-questions.html" data-path="frequently-asked-questions.html" title="FAQ">FAQ</a>
                            </li>
                            <!--
                              FIXME open-source
                              <li class='ac-nav-menu-list-icon'>
                                  <a class='ac-icon' href='https://github.com/algolia/algoliasearch-shopify/' data-path="https://github.com/algolia/algoliasearch-shopify/" title='GitHub repository'>
                                      <span class='ac-icon ac-icon-github'></span>
                                  </a>
                              </li>
                            -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

<header id="top-section" class="doc-header">
    <div class="row row-doc">
        <div class="large-12 columns">
            <a href="./">
                <img class="header-logo" src="https://res.cloudinary.com/hilnmyskv/image/upload/logo-algolia-dark.png">
            </a>
            <p class="lead header-lead">
                Plugin for
                <span>Shopify</span>
            </p>
        </div>
    </div>
</header>

<div class="row">
    <div class="medium-9 large-9 medium-push-3 large-push-3 columns">

        <article>
            <div id="algolia-search">
                <input type="text" id="algolia-search-input" placeholder="Search anywhere in the documentation...">
                <svg id="search-icon" width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M26.424 31.143a2 2 0 0 1 .004-2.824l1.12-1.12a2 2 0 0 1 2.824-.005l-3.948 3.948zm5.01-2.886l7.02 7.018a2 2 0 0 1 0 2.83l-1.12 1.12a2 2 0 0 1-2.83 0l-7.018-7.02 3.95-3.948zm-16.012 2.587c8.517 0 15.422-6.905 15.422-15.422S23.94 0 15.422 0 0 6.905 0 15.422s6.905 15.422 15.422 15.422zm0-3.856c6.388 0 11.566-5.178 11.566-11.566 0-6.388-5.178-11.567-11.566-11.567-6.388 0-11.567 5.18-11.567 11.567 0 6.388 5.18 11.566 11.567 11.566z" fill-rule="evenodd"/></svg>
                <svg id="search-clear-icon"width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M16.228 20L1.886 5.657 0 3.772 3.772 0l1.885 1.886L20 16.228 34.343 1.886 36.228 0 40 3.772l-1.886 1.885L23.772 20l14.342 14.343L40 36.228 36.228 40l-1.885-1.886L20 23.772 5.657 38.114 3.772 40 0 36.228l1.886-1.885L16.228 20z" fill-rule="evenodd"/></svg>
            </div>

            <header>
                <h1>Automated Synchronization</h1>

                <p class="lead">Understand the indexing flow and the generated operations.</p>
            </header>

            <hr>

            <div class="row">
                <div class="large-12 columns" id="content">
                    <h2 id="introduction"><a class="heading-anchor" href="#introduction"><span></span></a>Introduction</h2>
<p>By default, this plugin will ensure your WordPress content flagged for indexing stays in sync with Algolia.</p>
<div class="alert alert-info">This behaviour does not rely on CRON, but uses a custom private post_type <code>algolia_task</code>. </div>

<p>We support the automatic synchronization of 3 types of content:</p>
<ul>
<li>Post Types,</li>
<li>Taxonomies,</li>
<li>Users.</li>
</ul>
<p>Each content type has its own indexing flow.</p>
<h2 id="triggers"><a class="heading-anchor" href="#triggers"><span></span></a>Triggers</h2>
<p>We try as much as possible to automate the indexing for you. That means that we listen for events like &apos;post was saved&apos; to push the new data to Algolia.</p>
<p><strong>We synchronize posts when:</strong></p>
<ul>
<li>A post was created or updated,</li>
<li>A post was deleted,</li>
<li>The featured image was changed.</li>
</ul>
<p><strong>We synchronize taxonomy terms when:</strong></p>
<ul>
<li>A term was created or updated,</li>
<li>A term was deleted.</li>
</ul>
<p><strong>We synchronize users when:</strong></p>
<ul>
<li>A user was created or updated,</li>
<li>A term was deleted,</li>
<li>A post was created or updated,</li>
<li>A post was deleted.</li>
</ul>
<div class="alert alert-warning">We synchronize without trying to detect if the updates has lead to real changes. This ensures consistency and easier extensibility.</div>

<h2 id="indexing-decision"><a class="heading-anchor" href="#indexing-decision"><span></span></a>Indexing Decision</h2>
<p>The existence of an indexing task, does not necessarily mean that the data will be pushed to Algolia.</p>
<p>Indeed, before each post, term and user indexing, we decide if the item should be indexed or not. If it should, then we re-push the data for the item otherwise we remove it from the index.</p>
<p><strong>Default decisions:</strong></p>
<table>
<thead>
<tr>
<th>Content Type</th>
<th>Rule</th>
</tr>
</thead>
<tbody>
<tr>
<td>Searchable Post</td>
<td>We only index a post when it is in the <code>published</code> state and if its post type is not <code>excluded_from_search</code>.</td>
</tr>
<tr>
<td>Post</td>
<td>We only index a post when it is in the <code>published</code> state if it has no password.</td>
</tr>
<tr>
<td>Term</td>
<td>We only index a term if it has been assigned to at least 1 post (count &gt; 0).</td>
</tr>
<tr>
<td>User</td>
<td>We index a user if he has authored at least 1 post.</td>
</tr>
</tbody>
</table>
<p>You can hook into the indexing decision making for searchable posts, posts, terms and users by using respectively the <code>algolia_should_index_searchable_post</code>, <code>algolia_should_index_post</code>, <code>algolia_should_index_term</code> and <code>algolia_should_index_user</code> filters.</p>
<p><strong>Here is an example for filtering user indexing:</strong></p>
<pre><code class="hljs php"><span class="hljs-preprocessor">&lt;?php</span>

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@param</span> bool $should_index
 * <span class="hljs-doctag">@param</span> WP_User $user
 *
 * <span class="hljs-doctag">@return</span> bool
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter_user</span><span class="hljs-params">( <span class="hljs-variable">$should_index</span>, <span class="hljs-variable">$user</span> )</span> </span>{
    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">false</span> === <span class="hljs-variable">$should_index</span> ) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$user</span>-&gt;ID !== <span class="hljs-number">1</span>;
}

add_filter( <span class="hljs-string">&apos;algolia_should_index_user&apos;</span>, <span class="hljs-string">&apos;filter_user&apos;</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span> );</code></pre>

<p>In the above example, User with ID 1 would never get indexed. This example is trivial, but at least gives you a quick overview on how to filter your items to index.
Also note how we return <code>false</code> early on if the decision has already been taken to not index the content.</p>
<h2 id="queue-processing"><a class="heading-anchor" href="#queue-processing"><span></span></a>Queue processing</h2>
<p>Every time a change of your content is detected, see <a href="#triggers">previous section</a>, we queue a synchronization task with the minimum required information for the task to be handled.</p>
<p>When that happens, we directly try to trigger the processing of the queue. The queue follows the FIFO logic, and ensures there is only one task handled at the same time. For scalability reasons, each task handling is done in its own PHP process and triggered by an asynchronous http call.</p>
<div class="alert alert-warning">By default WordPress will ensure that your ssl certificate is valid on every remote call. If you have an invalid ssl certificate, the queue processing won&apos;t work.</div>

<h2 id="queue-processing-troubleshooting"><a class="heading-anchor" href="#queue-processing-troubleshooting"><span></span></a>Queue processing troubleshooting</h2>
<p>Queue processing is the most critical part of the plugin. If the queue processing doesn&apos;t work, then the whole plugin becomes un-usable.</p>
<p>If you have queue processing problems, please:</p>
<ul>
<li>Make sure you take advantage of built in logs and WordPress logs, see the <a href="logs.html">Debugging</a> section of the docs,</li>
<li>Check out the <a href="frequently-asked-questions.html">FAQ</a> for answers,</li>
<li>If you don&apos;t manage to solve the issue by yourself, ask for help, see: <a href="frequently-asked-questions.html">FAQ</a>.</li>
</ul>

                </div>
            </div>

            <ul class="menu simple text-center">
                <!--
                  FIXME open-source
                <li><a href="https://github.com/algolia/algoliasearch-shopify/edit/master/docs/src/indexing-flow.md" target="_blank"><i class="fi-pencil"></i> <span>Edit this Page</span></a></li>
                <li><a href="https://github.com/algolia/algoliasearch-shopify/issues/new?title=%5BAutomated Synchronization%5D%20ISSUE%20NAME%20HERE" target="_blank"><i class="fi-social-github"></i> <span>Report a Bug</span></a></li>
                -->
                <li><a href="http://stackoverflow.com/questions/tagged/algolia+shopify" target="_blank"><i class="fi-comment"></i> <span>Get Help</span></a></li>
            </ul>
        </article>
    </div>

    <div class="medium-3 large-3 medium-pull-9 large-pull-9 columns">
        <ul class="vertical menu" id="main-nav">
          <li class="menu-text">Getting Started</li>
          <li ><a href="installation.html">Installation</a></li>
          <li ><a href="configuration.html">Configuration</a></li>
          <!-- 
            <li ><a href="customize-autocomplete.html">Customize Autocomplete</a></li>
            <li ><a href="customize-search-page.html">Customize Search Page</a></li>

            <li class="menu-text">Indexing</li>
            <li ><a href="index-schema.html">Schemas</a></li>
            <li ><a href="indexing-settings.html">Settings</a></li>
            <li class="active"><a href="indexing-flow.html">Automated Sync.</a></li>
            <li ><a href="synonyms.html">Synonyms</a></li>
            <li ><a href="custom-attributes.html">Custom Attributes</a></li>
            <li ><a href="replicas.html">Index Replicas</a></li>

            <li class="menu-text">Extend</li>
            <li ><a href="extend-basics.html">Basics</a></li>

            <li class="menu-text">Debugging</li>
            <li ><a href="logs.html">Logs</a></li>

            <li class="menu-text">Integrations</li>
            <li ><a href="advanced-custom-fields.html">Advanced Custom Fields</a></li>
            <li ><a href="wpml.html">WPML</a></li>

            <li class="menu-text">Other</li>
            <li ><a href="internationalization.html">Internationalization</a></li>
            <li ><a href="resources.html">Additional Resources</a></li>
            <li ><a href="contribute.html">Contribute</a></li>
            <li ><a href="frequently-asked-questions.html">FAQ</a></li>
          -->
        </ul>
    </div>

</div>

<section class="ac-footer">
  <div class="ac-footer-container">
    <p class="ac-footer-links">
    <!--
      FIXME open-source
      Code licensed under
      <a href="#" class="ac-footer-link-item">MIT</a>
      <br>
      <a href="#" class="ac-footer-link-item">Github</a>
      <a href="#" class="ac-footer-link-item">issues</a>
    -->
      <a class="ac-footer-link-item" href="https://www.algolia.com/policies/privacy">Privacy policy</a>
    </p>
  </div>

    <div class="ac-footer-container ac-footer-brand">
        <p>This project is part of</p>
        <img class="ac-footer-brand-icon" src="https://res.cloudinary.com/hilnmyskv/image/upload/logo-community.svg">
        <figure>
            <img class="ac-footer-brand-logo" src="https://res.cloudinary.com/hilnmyskv/image/upload/v1463417234/algolia-community_n6tixd.svg">
            <figcaption>Algolia Community</figcaption>
        </figure>
        <a href="https://community.algolia.com/" class="ac-footer-btn ac-footer-btn-cta">See More</a>
        <span class="ac-icon ac-icon-love-dark"></span>
    </div>

    <p class="ac-footer-version">Latest version: 0.6.0</p>

    <div class="ac-footer-actions">
        <div class="footer-container">
            <p>Build unique search experiences with Algolia</p>
            <a href="https://www.algolia.com/why?utm_medium=social-owned&utm_source=shopify%20website&utm_campaign=homepage&utm_term=why" class="ac-footer-btn ac-footer-btn-ghost-grey">
                See Why
                <span class="ac-icon-triangle"></span>
            </a>
            <a href="https://www.algolia.com/users/sign_up?utm_medium=social-owned&utm_source=shopify%20website&utm_campaign=homepage&utm_term=get_started" class="ac-footer-btn ac-footer-btn-ghost-pink">Get Started For Free</a>
        </div>
    </div>
</section>

        <script src="vendor/jquery/jquery.js"></script>
        <script src="vendor/foundation-sites/foundation.js"></script>
        <script src="js/app.js"></script>
        <script src="js/responsiveNavigation.js"></script>
        
        
    <!-- GA -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-32446386-12', 'auto');
  ga('send', 'pageview');
</script>
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-N8JP8G" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-N8JP8G');</script>
<!-- Twitter -->
<script src="//platform.twitter.com/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid('ntr1j', { tw_sale_amount: 0, tw_order_quantity: 0 });</script>
<noscript>
  <img height="1" width="1" style="display:none;" alt="" src="https://analytics.twitter.com/i/adsct?txn_id=ntr1j&amp;p_id=Twitter&amp;tw_sale_amount=0&amp;tw_order_quantity=0">
  <img height="1" width="1" style="display:none;" alt="" src="//t.co/i/adsct?txn_id=ntr1j&amp;p_id=Twitter&amp;tw_sale_amount=0&amp;tw_order_quantity=0">
</noscript>
<!-- Facebook -->
<script>
  !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
  n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
  document,'script','//connect.facebook.net/en_US/fbevents.js');
  fbq('init', '1654938174769952');
  fbq('track', "PageView");</script>
<noscript>
  <img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1654938174769952&amp;ev=PageView&amp;noscript=1">
</noscript>
<!-- Addroll -->
<script type="text/javascript">
  adroll_adv_id = "TGR7R4XSGVGYVPX4LQBDFQ";
  adroll_pix_id = "YQNWNHGUUBD2JMY7BVOBWM";
  // adroll_email = "username@example.com"; // OPTIONAL: provide email to improve user identification
  (function () {
    var _onload = function(){
      if (document.readyState && !/loaded|complete/.test(document.readyState)){setTimeout(_onload, 10);return}
      if (!window.__adroll_loaded){__adroll_loaded=true;setTimeout(_onload, 50);return}
      var scr = document.createElement("script");
      var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
      scr.setAttribute('async', 'true');
      scr.type = "text/javascript";
      scr.src = host + "/j/roundtrip.js";
      ((document.getElementsByTagName('head') || [null])[0] ||
        document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
    };
    if (window.addEventListener) {window.addEventListener('load', _onload, false);}
    else {window.attachEvent('onload', _onload)}
  }());
</script>
    

        <script type="text/javascript">
            var $searchInput = $("#algolia-search-input");
            if ( $searchInput.length > 0 ) {
                var $searchIcon = $("#search-icon");
                var $clearIcon = $("#search-clear-icon");

                var myDocsearch = docsearch({
                    apiKey: '1ae927e7da3bb494ac95144488c316d2',
                    indexName: 'shopify_algolia',
                    inputSelector: '#algolia-search-input',
                    debug: false, // Set debug to true if you want to inspect the dropdown
                    autocompleteOptions: {
                        openOnFocus: true
                    }

                });

                $clearIcon.on("click", function() {
                    $(".aa-input").focus();
                    $clearIcon.hide();
                    $searchIcon.fadeIn();
                    myDocsearch.autocomplete.autocomplete.setVal("");
                });

                $searchInput.on("keyup", function() {
                    if ($searchInput.val().length === 0){
                        $clearIcon.hide();
                        $searchIcon.fadeIn();
                    } else {
                        $searchIcon.hide();
                        $clearIcon.fadeIn();
                    }
                });
            }
        </script>
    </body>
</html>
